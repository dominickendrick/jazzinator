!function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);const a=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o=[1,2,3,4,5,6,7].reduce((e,t)=>e.concat(function(e){return a.map(t=>{let n=t+e,a={instrument:"Grand Piano",noteString:n,note:t,octave:e,control:()=>l(a.instrument,a.noteString),sharp:2==t.length};return a})}(t)),[]),s={"Grand Piano":[{note:"A",octave:4,file:"/assets/audio/samples/grand_piano/piano-f-a4.wav"},{note:"A",octave:5,file:"/assets/audio/samples/grand_piano/piano-f-a5.wav"},{note:"A",octave:6,file:"/assets/audio/samples/grand_piano/piano-f-a6.wav"},{note:"C",octave:4,file:"/assets/audio/samples/grand_piano/piano-f-c4.wav"},{note:"C",octave:5,file:"/assets/audio/samples/grand_piano/piano-f-c5.wav"},{note:"C",octave:6,file:"/assets/audio/samples/grand_piano/piano-f-c6.wav"},{note:"D#",octave:4,file:"/assets/audio/samples/grand_piano/piano-f-d#4.wav"},{note:"D#",octave:5,file:"/assets/audio/samples/grand_piano/piano-f-d#5.wav"},{note:"D#",octave:6,file:"/assets/audio/samples/grand_piano/piano-f-d#6.wav"},{note:"F#",octave:4,file:"/assets/audio/samples/grand_piano/piano-f-f#4.wav"},{note:"F#",octave:5,file:"/assets/audio/samples/grand_piano/piano-f-f#5.wav"},{note:"F#",octave:6,file:"/assets/audio/samples/grand_piano/piano-f-f#6.wav"}]};function r(e,t){let[,n,a]=/^(\w[b\#]?)(\d)$/.exec(t);a=parseInt(a,10),n=function(e){switch(e){case"Bb":return"A#";case"Db":return"C#";case"Eb":return"D#";case"Gb":return"F#";case"Ab":return"G#";default:return e}}(n);let o=function(e,t,n){return e.slice().sort((e,a)=>{let o=Math.abs(u(t,n,e.note,e.octave)),s=Math.abs(u(t,n,a.note,a.octave));return o-s})[0]}(s[e],n,a),r=u(n,a,o.note,o.octave);return function(e){return fetch(encodeURIComponent(e)).then(e=>e.arrayBuffer()).then(e=>c.decodeAudioData(e))}(o.file).then(e=>({audioBuffer:e,distance:r}))}function i(e,t){return 12*t+a.indexOf(e)}function u(e,t,n,a){return i(e,t)-i(n,a)}let c=new AudioContext;function l(e,t){return r(e,t).then(({audioBuffer:e,distance:t})=>{let n=Math.pow(2,t/12),a=c.createBufferSource();return a.buffer=e,a.playbackRate.value=n,a.connect(c.destination),a})}function d(e){e.inputs,e.outputs;for(var t of e.inputs.values())t.onmidimessage=p}function f(){console.log("Error: Could not access MIDI devices.")}function p(e){var t=e.data[0],n=e.data[1],a=e.data.length>2?e.data[2]:0;switch(t){case 144:a>0?(!function(e){const t=v(e);document.getElementsByClassName(t)[0].classList.add("pressed"),l("Grand Piano",t).then(e=>{e.start()})}(n),console.log(e)):function(e){const t=v(e);document.getElementsByClassName(t)[0].classList.remove("pressed")}(n);break;case 128:noteOffCallback(n)}}function v(e){switch(console.log(e),!0){case e>=24&&e<=108:return console.log("in range"),function(e){const t=e-24,n=Math.floor(t/12)+1;return a[t%12]+n}(e);default:return null}}navigator.requestMIDIAccess?(console.log("This browser supports WebMIDI!"),navigator.requestMIDIAccess().then(d,f)):console.log("WebMIDI is not supported in this browser."),function(e,t){let n=document.createElement("ol");t.forEach(e=>{let t=document.createElement("li"),a=document.createElement("button"),o=n.appendChild(t);a.addEventListener("mousedown",()=>{e.control().then(e=>{a.addEventListener("mouseup",()=>{}),e.start()})}),a.textContent=e.noteString,a.classList.add(e.noteString),a.classList.add("pianoKey"),e.sharp&&a.classList.add("sharp"),o.appendChild(a)}),e.appendChild(n)}(document.querySelector(".piano"),o)}]);