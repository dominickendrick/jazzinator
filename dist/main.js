!function(e){var n={};function t(a){if(n[a])return n[a].exports;var o=n[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:a})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(a,o,function(n){return e[n]}.bind(null,o));return a},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=2)}([function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o=[1,2,3,4,5,6,7].reduce(function(e,n){return e.concat(function(e){return a.map(function(n){var t=n+e,a={instrument:"Grand Piano",noteString:t,note:n,octave:e,control:function(){return f(a.instrument,a.noteString)},sharp:2==n.length};return a})}(n))},[]),r={"Grand Piano":[{note:"A",octave:4,file:"/assets/audio/samples/grand_piano/piano-f-a4.wav"},{note:"A",octave:5,file:"/assets/audio/samples/grand_piano/piano-f-a5.wav"},{note:"A",octave:6,file:"/assets/audio/samples/grand_piano/piano-f-a6.wav"},{note:"C",octave:4,file:"/assets/audio/samples/grand_piano/piano-f-c4.wav"},{note:"C",octave:5,file:"/assets/audio/samples/grand_piano/piano-f-c5.wav"},{note:"C",octave:6,file:"/assets/audio/samples/grand_piano/piano-f-c6.wav"},{note:"D#",octave:4,file:"/assets/audio/samples/grand_piano/piano-f-d#4.wav"},{note:"D#",octave:5,file:"/assets/audio/samples/grand_piano/piano-f-d#5.wav"},{note:"D#",octave:6,file:"/assets/audio/samples/grand_piano/piano-f-d#6.wav"},{note:"F#",octave:4,file:"/assets/audio/samples/grand_piano/piano-f-f#4.wav"},{note:"F#",octave:5,file:"/assets/audio/samples/grand_piano/piano-f-f#5.wav"},{note:"F#",octave:6,file:"/assets/audio/samples/grand_piano/piano-f-f#6.wav"}]};function i(e,n){var t=/^(\w[b\#]?)(\d)$/.exec(n);if(t&&t[1]&&t[2]){var a=t[1],o=t[2],i=parseInt(o,10),s=function(e){switch(e){case"Bb":return"A#";case"Db":return"C#";case"Eb":return"D#";case"Gb":return"F#";case"Ab":return"G#";default:return e}}(a),f=function(e,n,t){return e.slice().sort(function(e,a){var o=Math.abs(u(n,t,e.note,e.octave)),r=Math.abs(u(n,t,a.note,a.octave));return o-r})[0]}(r[e],s,i),l=u(s,i,f.note,f.octave);return function(e){return fetch(encodeURIComponent(e)).then(function(e){return e.arrayBuffer()}).then(function(e){return c.decodeAudioData(e)})}(f.file).then(function(e){return{audioBuffer:e,distance:l}})}}function s(e,n){return 12*n+a.indexOf(e)}function u(e,n,t,a){return s(e,n)-s(t,a)}var c=new AudioContext;function f(e,n){var t=i(e,n);t&&t.then(function(e){var n=e.audioBuffer,t=e.distance,a=Math.pow(2,t/12),o=c.createBufferSource();return o.buffer=n,o.playbackRate.value=a,o.connect(c.destination),o})}n.getSampleSource=f,n.renderPianoUi=function(e,n){var t=document.createElement("ol");n.forEach(function(e){var n=document.createElement("li"),a=document.createElement("button"),o=t.appendChild(n);a.addEventListener("mousedown",function(){var n=e.control();n&&n.then(function(e){a.addEventListener("mouseup",function(){}),e.start()})}),a.textContent=e.noteString,a.classList.add(e.noteString),a.classList.add("pianoKey"),e.sharp&&a.classList.add("sharp"),o.appendChild(a)}),null!=e&&e.appendChild(t)},n.PIANO_NOTES=o,n.OCTAVE=a},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.initMidi=void 0;var a=t(0);function o(e){e.inputs,e.outputs;var n=!0,t=!1,a=void 0;try{for(var o,r=e.inputs.values()[Symbol.iterator]();!(n=(o=r.next()).done);n=!0){o.value.onmidimessage=i}}catch(e){t=!0,a=e}finally{try{!n&&r.return&&r.return()}finally{if(t)throw a}}}function r(){console.log("Error: Could not access MIDI devices.")}function i(e){var n=e.data[0],t=e.data[1],o=e.data.length>2?e.data[2]:0;switch(n){case 144:o>0?(!function(e){var n=s(e);document.getElementsByClassName(n)[0].classList.add("pressed"),(0,a.getSampleSource)("Grand Piano",n).then(function(e){e.start()})}(t),console.log(e)):function(e){var n=s(e);document.getElementsByClassName(n)[0].classList.remove("pressed")}(t);break;case 128:noteOffCallback(t)}}function s(e){switch(console.log(e),!0){case e>=24&&e<=108:return console.log("in range"),function(e){var n=e-24,t=Math.floor(n/12)+1,o=n%12;return a.OCTAVE[o]+t}(e);default:return null}}n.initMidi=function(){navigator.requestMIDIAccess?(console.log("This browser supports WebMIDI!"),navigator.requestMIDIAccess().then(o,r)):console.log("WebMIDI is not supported in this browser.")}},function(e,n,t){"use strict";var a=t(0);(0,t(1).initMidi)(),(0,a.renderPianoUi)(document.querySelector(".piano"),a.PIANO_NOTES)}]);
//# sourceMappingURL=main.js.map