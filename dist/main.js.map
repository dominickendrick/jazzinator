{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/piano.js","webpack:///./src/midi.js","webpack:///./src/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","OCTAVE","PIANO_NOTES","reduce","arr","currentValue","concat","octave","map","note","noteString","instrument","control","getSampleSource","sharp","length","getNotesForOctave","SAMPLE_LIBRARY","Grand Piano","file","getSample","noteAndOctave","match","exec","requestedNote","requestedOctave","parseInt","flatToSharp","sample","sampleBank","slice","sort","sampleA","sampleB","distanceToA","Math","abs","getNoteDistance","distanceToB","getNearestSample","distance","path","fetch","encodeURIComponent","then","response","arrayBuffer","audioContext","decodeAudioData","fetchSample","audioBuffer","noteValue","indexOf","note1","octave1","note2","octave2","AudioContext","_ref","playbackRate","pow","bufferSource","createBufferSource","buffer","connect","destination","renderPianoUi","container","notes","keysWrapper","document","createElement","forEach","list","button","listElement","appendChild","addEventListener","start","textContent","classList","add","_piano","onMIDISuccess","midiAccess","inputs","outputs","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","values","iterator","next","done","onmidimessage","getMIDIMessage","err","return","onMIDIFailure","console","log","message","command","data","velocity","getKeyFromMidiId","getElementsByClassName","noteOn","remove","noteOff","noteOffCallback","id","absoluteId","floor","noteIndex","getKeyFromId","initMidi","navigator","requestMIDIAccess","querySelector"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","// @flow\n\ntype Note = {\n    instrument: string,\n    noteString: string,\n    note: string,\n    octave: number,\n    control: () => ?Promise<AudioBufferSourceNode>,\n    sharp: boolean\n}\n\ntype Sample = {\n    audioBuffer: AudioBuffer,\n    distance: number\n}\n\ntype SampleAsset = {\n    note: string,\n    octave: number,\n    file: string\n}\n\nconst OCTAVE = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n\nconst PIANO_OCTAVES: Array<number> = [1, 2, 3, 4, 5, 6, 7]\n\nconst PIANO_NOTES: Array<Note> = PIANO_OCTAVES.reduce((arr, currentValue) => {\n    return arr.concat(getNotesForOctave(currentValue))\n}, []);\n\nconst SAMPLE_LIBRARY: { [string]: Array<SampleAsset> } = {\n    'Grand Piano': [\n        { note: 'A', octave: 4, file: '/assets/audio/samples/grand_piano/piano-f-a4.wav' },\n        { note: 'A', octave: 5, file: '/assets/audio/samples/grand_piano/piano-f-a5.wav' },\n        { note: 'A', octave: 6, file: '/assets/audio/samples/grand_piano/piano-f-a6.wav' },\n        { note: 'C', octave: 4, file: '/assets/audio/samples/grand_piano/piano-f-c4.wav' },\n        { note: 'C', octave: 5, file: '/assets/audio/samples/grand_piano/piano-f-c5.wav' },\n        { note: 'C', octave: 6, file: '/assets/audio/samples/grand_piano/piano-f-c6.wav' },\n        { note: 'D#', octave: 4, file: '/assets/audio/samples/grand_piano/piano-f-d#4.wav' },\n        { note: 'D#', octave: 5, file: '/assets/audio/samples/grand_piano/piano-f-d#5.wav' },\n        { note: 'D#', octave: 6, file: '/assets/audio/samples/grand_piano/piano-f-d#6.wav' },\n        { note: 'F#', octave: 4, file: '/assets/audio/samples/grand_piano/piano-f-f#4.wav' },\n        { note: 'F#', octave: 5, file: '/assets/audio/samples/grand_piano/piano-f-f#5.wav' },\n        { note: 'F#', octave: 6, file: '/assets/audio/samples/grand_piano/piano-f-f#6.wav' }\n    ]\n};\n\nfunction flatToSharp(note: string): string {\n    switch (note) {\n        case 'Bb':\n            return 'A#';\n        case 'Db':\n            return 'C#';\n        case 'Eb':\n            return 'D#';\n        case 'Gb':\n            return 'F#';\n        case 'Ab':\n            return 'G#';\n        default:\n            return note;\n    }\n}\n\nfunction getSample(instrument:string , noteAndOctave: string): ?Promise<Sample> {\n    const match: ?Array<string> = /^(\\w[b\\#]?)(\\d)$/.exec(noteAndOctave);\n\n    if (match && match[1] && match[2]) {\n        const requestedNote = match[1]\n        const requestedOctave = match[2]\n\n        const octave = parseInt(requestedOctave, 10);\n        const note = flatToSharp(requestedNote);\n\n        const sampleBank: Array<SampleAsset> = SAMPLE_LIBRARY[instrument];\n\n        const sample: SampleAsset = getNearestSample(sampleBank, note, octave);\n        const distance =\n            getNoteDistance(note, octave, sample.note, sample.octave);\n\n        return fetchSample(sample.file).then(audioBuffer => ({\n            audioBuffer: audioBuffer,\n            distance: distance\n        }));\n    }\n\n}\n\nfunction noteValue(note: string , octave: number): number {\n    return octave * 12 + OCTAVE.indexOf(note);\n}\n\nfunction getNoteDistance(note1: string, octave1: number, note2: string, octave2: number): number {\n    return noteValue(note1, octave1) - noteValue(note2, octave2);\n}\n\nfunction getNearestSample(sampleBank: Array<SampleAsset>, note: string, octave: number): SampleAsset {\n    let sortedBank = sampleBank.slice().sort((sampleA, sampleB) => {\n        let distanceToA =\n            Math.abs(getNoteDistance(note, octave, sampleA.note, sampleA.octave));\n        let distanceToB =\n            Math.abs(getNoteDistance(note, octave, sampleB.note, sampleB.octave));\n        return distanceToA - distanceToB;\n    });\n    return sortedBank[0];\n}\n\nlet audioContext = new AudioContext();\n\nfunction fetchSample(path: string): Promise<AudioBuffer> {\n    return fetch(encodeURIComponent(path))\n        .then(response => response.arrayBuffer())\n        .then(arrayBuffer => audioContext.decodeAudioData(arrayBuffer));\n}\n\nfunction getSampleSource(instrument: string, note: string): ?Promise<AudioBufferSourceNode> {\n    const sample: ?Promise<Sample> = getSample(instrument, note)\n\n    if (sample) {\n        sample.then(({ audioBuffer, distance }) => {\n            let playbackRate = Math.pow(2, distance / 12);\n            let bufferSource = audioContext.createBufferSource();\n            bufferSource.buffer = audioBuffer;\n            bufferSource.playbackRate.value = playbackRate;\n            bufferSource.connect(audioContext.destination);\n            return bufferSource\n        });\n    }\n}\n\nfunction getNotesForOctave(octave: number): Array<Note> {\n    return OCTAVE.map(note => {\n        const instrument = 'Grand Piano'\n            // The note and octave as a string ie 'C4'\n        const noteString = note + octave\n\n        const key = {\n            instrument,\n            noteString,\n            note,\n            octave,\n            control: () => getSampleSource(key.instrument, key.noteString),\n            //Boolean if note is a sharp\n            sharp: note.length == 2\n        }\n        return key\n    });\n}\n\nfunction renderPianoUi(container: ?Element , notes: Array<Note>): void {\n    const keysWrapper = document.createElement('ol')\n\n    notes.forEach(key => {\n        const list = document.createElement('li')\n        const button = document.createElement('button')\n        const listElement = keysWrapper.appendChild(list)\n\n        button.addEventListener('mousedown', () => { \n            const sample = key.control();\n            if (sample) {\n                sample.then(buffer => {\n                    button.addEventListener('mouseup', () => { //buffer.stop() \n                    })\n                    buffer.start()\n               })\n            }\n        })\n\n        button.textContent = key.noteString\n        button.classList.add(key.noteString)\n        button.classList.add('pianoKey')\n\n        if (key.sharp) {\n            button.classList.add('sharp')\n        }\n\n        listElement.appendChild(button)\n    })\n\n    if (container != null) {\n        container.appendChild(keysWrapper)\n    }\n}\n\n\n//TODO: Add types\n//TODO: Add tests\n//TODO: rename styles to use BEM or use a component framework\n//TODO: use component framework ?\n//TODO: load tunes\n//TODO: add compatable scales\n//TODO: remap keys to fit scales and chord shapes\n\nexport { getSampleSource, renderPianoUi, PIANO_NOTES, OCTAVE };","import { getSampleSource, OCTAVE } from \"./piano.js\";\n\nfunction initMidi() {\n    // Request MIDI access\n    if (navigator.requestMIDIAccess) {\n        console.log('This browser supports WebMIDI!');\n\n        navigator.requestMIDIAccess().then(onMIDISuccess, onMIDIFailure);\n\n    } else {\n        console.log('WebMIDI is not supported in this browser.');\n    }\n}\n\n// Function to run when requestMIDIAccess is successful\nfunction onMIDISuccess(midiAccess) {\n    var inputs = midiAccess.inputs;\n    var outputs = midiAccess.outputs;\n\n    // Attach MIDI event \"listeners\" to each input\n    for (var input of midiAccess.inputs.values()) {\n        input.onmidimessage = getMIDIMessage;\n    }\n}\n\n// Function to run when requestMIDIAccess fails\nfunction onMIDIFailure() {\n    console.log('Error: Could not access MIDI devices.');\n}\n\n// Function to parse the MIDI messages we receive\n// For this app, we're only concerned with the actual note value,\n// but we can parse for other information, as well\nfunction getMIDIMessage(message) {\n    var command = message.data[0];\n    var note = message.data[1];\n    var velocity = (message.data.length > 2) ? message.data[2] : 0; // a velocity value might not be included with a noteOff command\n    switch (command) {\n        case 144: // note on\n            if (velocity > 0) {\n                noteOn(note);\n                console.log(message)\n            } else {\n                noteOff(note);\n            }\n            break;\n        case 128: // note off\n            noteOffCallback(note);\n            break;\n        // we could easily expand this switch statement to cover other types of commands such as controllers or sysex\n    }\n}\n\n// Function to handle noteOn messages (ie. key is pressed)\n// Think of this like an 'onkeydown' event\nfunction noteOn(note) {\n    const key = getKeyFromMidiId(note)\n    const keyElement = document.getElementsByClassName(key)[0]\n    keyElement.classList.add('pressed')\n    getSampleSource('Grand Piano', key).then(buffer => {\n        buffer.start()\n    });\n}\n\n// Function to handle noteOff messages (ie. key is released)\n// Think of this like an 'onkeyup' event\nfunction noteOff(note) {\n    const key = getKeyFromMidiId(note)\n    const keyElement = document.getElementsByClassName(key)[0]\n    keyElement.classList.remove('pressed')\n}\n\nfunction getKeyFromId(id) {\n    //get the note value as one of the keys from 1-88\n    const absoluteId = id - 24;\n    const octave = Math.floor(absoluteId / 12) + 1\n    const noteIndex = (absoluteId % 12);\n    return OCTAVE[noteIndex] + octave;\n}\n\n//id is an interger, returns a string in format note octave ie \"C4\" or null\nfunction getKeyFromMidiId(id) {\n    console.log(id)\n\n    switch(true) {\n        case (id >= 24 && id <= 108):\n            console.log(\"in range\");\n            return getKeyFromId(id)\n        break;\n        default:\n            return null;\n    }\n}\n\nexport { initMidi };\n","import { renderPianoUi, PIANO_NOTES } from './piano.js';\nimport { initMidi } from './midi.js';\n\ninitMidi();\n\nrenderPianoUi(document.querySelector('.piano'), PIANO_NOTES);"],"sourceRoot":""}